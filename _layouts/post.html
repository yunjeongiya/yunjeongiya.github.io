---
layout: default
---

<article class="post">
  <div class="post-header-meta">
    <h1 class="post-title">{{ page.title | escape }}</h1>
    <div class="post-meta">
      <time datetime="{{ page.date | date_to_xmlschema }}">
        {{ page.date | date: "%Y-%m-%d %H:%M" }}
      </time>
      {% if page.categories.size > 0 %}
        • {{ page.categories | join: ", " }}
      {% endif %}
      {% if page.tags.size > 0 %}
        • Tags: {{ page.tags | join: ", " }}
      {% endif %}
    </div>
  </div>

  <div class="post-content" id="post-content">
    {{ content }}
  </div>

  <!-- Comments List -->
  <div class="post-comments-section">
    <h2 style="color: var(--keyword); margin-bottom: 20px; font-size: 20px; border-top: 1px solid var(--border-color); padding-top: 40px;">
      <i class="codicon codicon-comment" style="margin-right: 8px;"></i>Comments
    </h2>
    <div id="comments-list"></div>
  </div>
</article>

<!-- Right Panel Data (Outline + Minimap) -->
<script>
window.postOutline = [];
document.addEventListener('DOMContentLoaded', function() {
  const content = document.getElementById('post-content');
  const headings = content.querySelectorAll('h2, h3');
  
  headings.forEach(function(heading) {
    const level = heading.tagName.toLowerCase();
    const text = heading.textContent;
    const id = heading.id || text.toLowerCase().replace(/[^a-z0-9가-힣]+/g, '-');
    heading.id = id;
    
    window.postOutline.push({
      level: level,
      text: text,
      id: id
    });
  });
  
  if (window.updateOutline) {
    window.updateOutline();
  }
  
  if (window.updateMinimap) {
    window.updateMinimap();
  }
});
</script>

<!-- Terminal Panel Data -->
{% if page.tags.size > 0 %}
<script>
window.postTags = {{ page.tags | jsonify }};
</script>
{% endif %}

<!-- Git Comments System -->
<script type="module">
  import { GitTerminal } from '/assets/js/git-terminal.js';
  import { GitCommentsList } from '/assets/js/git-comments-list.js';

  const postId = '{{ page.id | replace: "/", "-" }}';
  const apiUrl = 'https://blog-comments-jnlald3nf-checkus.vercel.app';

  console.log('[Comments] postId:', postId);
  console.log('[Comments] apiUrl:', apiUrl);

  // 터미널 패널 (댓글 작성)
  const terminal = new GitTerminal('terminal-git-comments', postId, apiUrl);

  // 본문 하단 (댓글 목록)
  const commentsList = new GitCommentsList('comments-list', postId, apiUrl);

  // 터미널에서 댓글 작성 시 목록 갱신
  terminal.onCommentCreated = () => {
    console.log('[Comments] Refreshing comment list...');
    commentsList.refresh();
  };
</script>
